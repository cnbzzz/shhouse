var APF={log:function(a){}};APF.Namespace={register:function(d){var c=d.split(".");var a=window;for(var b=0;b<c.length;b++){if(typeof a[c[b]]=="undefined"){a[c[b]]=new Object()}a=a[c[b]]}return a}};APF.Utils={getWindowSize:function(){var b=0,a=0;if(typeof(window.innerWidth)=="number"){b=window.innerWidth;a=window.innerHeight}else{if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)){b=document.documentElement.clientWidth;a=document.documentElement.clientHeight}else{if(document.body&&(document.body.clientWidth||document.body.clientHeight)){b=document.body.clientWidth;a=document.body.clientHeight}}}return{width:b,height:a}},getScroll:function(){var b=0,a=0;if(typeof(window.pageYOffset)=="number"){a=window.pageYOffset;b=window.pageXOffset}else{if(document.body&&(document.body.scrollLeft||document.body.scrollTop)){a=document.body.scrollTop;b=document.body.scrollLeft}else{if(document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)){a=document.documentElement.scrollTop;b=document.documentElement.scrollLeft}}}return{left:b,top:a}},setCookie:function(c,e,a,h,d,g){var b=new Date();b.setTime(b.getTime());if(a){a=a*1000*60*60*24}var f=new Date(b.getTime()+(a));document.cookie=c+"="+escape(e)+((a)?";expires="+f.toGMTString():"")+((h)?";path="+h:"")+((d)?";domain="+d:"")+((g)?";secure":"")},getCookie:function(a){var f=document.cookie.split(";");var b="";var d="";var e="";var c=false;for(i=0;i<f.length;i++){b=f[i].split("=");d=b[0].replace(/^\s+|\s+$/g,"");if(d==a){c=true;if(b.length>1){e=unescape(b[1].replace(/^\s+|\s+$/g,""))}return e;break}b=null;d=""}if(!c){return null}},deleteCookie:function(a,c,b){if(this.getCookie(a)){document.cookie=a+"="+((c)?";path="+c:"")+((b)?";domain="+b:"")+";expires=Thu, 01-Jan-1970 00:00:01 GMT"}},setScrollTop:function(a){if(document.body){document.body.scrollTop=a;if(document.body.scrollTop==0){if(document.documentElement){document.documentElement.scrollTop=a}}}else{if(document.documentElement){document.documentElement.scrollTop=a}}},getScrollTop:function(){return document.body?document.body.scrollTop||document.documentElement.scrollTop:document.documentElement.scrollTop},gotoScrollTop:function(f,d){var b=APF.Utils.getScrollTop(),h=0,g=0;var d=d||1;var f=f||0;var a=b>f?1:0;(function(){b=APF.Utils.getScrollTop();h=a?b-f:f-b;g=a?b-h/15*d:b+1+h/15*d;APF.Utils.setScrollTop(g);if(h<=0||b==APF.Utils.getScrollTop()){return}setTimeout(arguments.callee,10)})()}};if(typeof JSON!=="object"){JSON={}}(function(){var rx_one=/^[\],:{}\s]*$/,rx_two=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rx_three=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rx_four=/(?:^|:|,)(?:\s*\[)+/g,rx_escapable=/[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,rx_dangerous=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;function f(n){return n<10?"0"+n:n}function this_value(){return this.valueOf()}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};Boolean.prototype.toJSON=this_value;Number.prototype.toJSON=this_value;String.prototype.toJSON=this_value}var gap,indent,meta,rep;function quote(string){rx_escapable.lastIndex=0;return rx_escapable.test(string)?'"'+string.replace(rx_escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==="string"){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);rx_dangerous.lastIndex=0;if(rx_dangerous.test(text)){text=text.replace(rx_dangerous,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(rx_one.test(text.replace(rx_two,"@").replace(rx_three,"]").replace(rx_four,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());APF.Namespace.register("ajk");(function(a){ajk.inherit=function(){var f=Array.prototype.splice,c=arguments;var b=c[c.length-1];f.apply(c,[-1,1]);var e=function(){for(var g=0;g<c.length;g++){if(c[g]){c[g].apply(this,arguments)}}b.apply(this,arguments)};for(var d=0;d<c.length;d++){if(c[d]){a.extend(e.prototype,c[d].prototype)}}a.extend(e.prototype,b.prototype);return e};ajk.Observer=function(){this.ob={}};ajk.Observer.prototype.on=function(g,f){var e=g.split(" ");var d={};for(var b=0;b<e.length;b++){if(!this.ob[e[b]]){this.ob[e[b]]=[]}var c=this.ob[e[b]].push(f);d[e[b]]=c-1}return d};ajk.Observer.prototype.off=function(b,d){if(d!==undefined&&!a.isArray(d)){d=[d]}for(var c=0;c<this.ob[b].length;c++){if(d===undefined||a.inArray(c,d)>-1){this.ob[b][c]=undefined}}};ajk.Observer.prototype.trigger=function(c,d){var f;if(!this.ob[c]){return f}var b=d||[];for(var e=0;this.ob[c]&&e<this.ob[c].length;e++){if(!this.ob[c][e]){continue}var g=this.ob[c][e].apply(this,b);f=(f===false)?f:g}return f};ajk.Observer.prototype.once=function(c,e){var b=this;var d=b.on(c,function(){e.apply(this,arguments);b.off(c,d[c])})}})(jQuery);APF.Namespace.register("ajk");(function(){var logger;var siteName=(function(){var hostData=document.location.host.match(/^(\w+)\.(\w+)\./);if(hostData){return"pc"}else{return"unknown"}})();var rAf=function(callback){window.setTimeout(callback,1000/10)};ajk.Logger=logger={sojSite:"",sojPage:"",sojPageName:"",errorSite:siteName};logger.setSite=function(site){this.sojSite=site||""};logger.setPage=function(page){this.sojPage=page||""};logger.setPageName=function(pagename){this.sojPageName=pagename||""};logger.setCtid=function(ctid){this.ctid=ctid||""};logger.config={devLogURL:"//s.anjuke.test/ts.html?",logURL:"//m.anjuke.com/ts.html?",devSojURL:"//s.anjuke.test/stb",isDev:/dev|test/.test(document.domain),blackList:["Player","baiduboxapphomepagetag","onTouchMoveInPage"]};logger.isblack=function(str){var self=this;var i,reg,length,blackList=self.config.blackList;if(typeof str!=="string"){return true}for(i=0,length=blackList.length;i<length;i++){reg=new RegExp(blackList[i],"g");if(reg.test(str)){return true}}};logger.sendError=function(params){var self=this;var errorinfo="tp=error&site="+self.errorSite+"&msg=",key,url,arr=[],image,msg;if(typeof params==="string"){msg=params}if(typeof params==="object"){for(key in params){if(params.hasOwnProperty(key)){arr.push(key+":"+encodeURIComponent(JSON.stringify(params[key])))}}msg=arr.join(",")}if(self.isblack(msg)){return false}image=new Image();if(self.config.isDev){url=self.config.devLogURL+errorinfo+msg}else{url=self.config.logURL+errorinfo+msg}image.src=url;return true};var getScreen=function(){var sinfo={};sinfo.w=$(window).width().toString();sinfo.h=$(window).height().toString();sinfo.r=(window.devicePixelRatio&&window.devicePixelRatio>=2?1:0).toString();getScreen=function(){return sinfo};return sinfo};logger.sendSoj=function(op){var self=this;var _site=op.site||self.sojSite,soj=new SiteTracker(),t_params;if(op.customparam){soj.setCustomParam(op.customparam)}if(self.config.isDev){t_params={target_url:self.config.devSojURL}}var _page=op.page||self.sojPage,_ctid=self.ctid,_pageName=op.pageName||self.sojPageName||_page;soj.setPage(_page);soj.setPageName(_pageName);soj.setSite(_site);soj.setScreen(getScreen());soj.setNCtid(_ctid);soj.setReferer(op.r||document.referrer);if(op.NGuid){soj.setNGuid(op.NGuid)}if(op.NUid){soj.setNUid(op.NUid)}if(op.h){if(!t_params){t_params={}}t_params.h=op.h}soj.track(t_params);try{if(!/npv/.test(_site)){var trackUrl=soj.getParams();delete trackUrl.cp;delete trackUrl.sc;window._trackURL=JSON.stringify(trackUrl);loadTrackjs()}}catch(e){}function loadTrackjs(){var s=document.createElement("script");s.type="text/javascript";s.async=true;s.src="//tracklog.58.com/referrer_anjuke_pc.js?_="+Math.random();var b=document.body;s.onload=function(){soj.setSite(_site+"-npv");soj.setPage(_page+"_tracklog");soj.setPageName(_pageName+"_tracklog");soj.track(t_params)};s.onerror=function(){soj.setSite(_site+"-npv");soj.setPage(_page+"_tracklog_error");soj.setPageName(_pageName+"_tracklog_error");soj.track(t_params)};b.appendChild(s)}};logger.track=function(p,cp,pn){if(!pn){pn=p}if($.isPlainObject(cp)){cp=JSON.stringify(cp)}logger.sendSoj({site:"anjuke-npv",page:p,pageName:pn,customparam:cp||""})};logger.addLinkSoj=function(selector,attr,param){$("body").on("click",selector,function(e){var soj=$(this).data(attr||"soj")||$(this).attr(attr||"_soj"),_soj=$.trim(soj),href=$.trim($(this).attr("href")),_param=param||"from",_target=$(this).attr("target"),_hasTarget=_target!==undefined,_href;if(!_soj){return}if(!href){return}if(href.toLowerCase().indexOf("javascript")===0){return}e.preventDefault();e.stopPropagation();href=href.replace(/(&from=(.)*$)|(\?from=(.)*$)/,"");_href=(href.indexOf("?")!==-1)?href+"&"+_param+"="+_soj:href+"?"+_param+"="+_soj;if(_hasTarget){if(!
/*@cc_on!@*/
0){var winoper=window.open(_href,_target);winoper&&winoper.focus()}else{var _el=document.createElement("a");_el.href=_href;_el.target=_target;$(_el).appendTo("body").get(0).click();$(_el).remove()}}else{location.href=_href}})};logger.Exposure=function(op){var defaults={site:"",trackTag:"data-trace",delay:50,page:"",pageName:"",NUid:"",NGuid:"",prefix:""};this.ops=$.extend(defaults,op);this.domCache=[];this.pageViewHeight=$(window).height();this.timer=null;this.dataCache=[];this.expStatus=false;this.init()};logger.Exposure.prototype={constructor:logger.Exposure,add:function(list){var _this=this;this.expStatus=true;list.each(function(index,el){_this.domCache.push($(el))})},init:function(){var wd=$(window),self=this;wd.resize($.proxy(this.resize,this));wd.on("beforeunload",$.proxy(this.beforeunload,this));rAf(scroll);function scroll(){rAf(scroll);if(!self.expStatus){return}clearTimeout(self.timer);if(self.domCache.length===0){self.expStatus=false;self.buildData();return}self.timer=setTimeout(function(){$.proxy(self.addData,self)()},self.ops.delay)}},resize:function(){this.pageViewHeight=$(window).height()},beforeunload:function(){this.buildData()},scroll:function(){},sendExp:function(result){logger.sendSoj({NGuid:this.ops.NGuid,NUid:this.ops.NUid,site:this.ops.site,page:this.ops.prefix+this.ops.page,pageName:this.ops.prefix+this.ops.pageName,customparam:result})},addData:function(){var pageViewHeight=this.pageViewHeight,topY=$(window).scrollTop(),botY=topY+pageViewHeight,_this=this;if(this.domCache.length===0){return}$.each(this.domCache,function(index,val){var _topY,attr;if(!val){return}_topY=val.offset?val.offset().top:0;if(_topY>topY&&_topY<botY){attr=val.attr(_this.ops.trackTag);if(attr){_this.dataCache.push(attr)}delete _this.domCache[index]}});this.buildData()},buildData:function(){var _this=this,result={},r=[],exp,key,length,i;if(this.dataCache.length===0){return}exp=eval("(["+this.dataCache.join(",")+"])");this.dataCache=[];for(i=0,length=exp.length;i<length;i++){for(key in exp[i]){if(!result[key]){result[key]=[]}result[key].push(exp[i][key])}}for(key in result){r.push('"'+key+'":['+result[key].join(",")+"]")}this.sendExp('{"exposure":{'+r.join(",")+"}}");$.each(this.domCache,function(index,val){if(!val){_this.domCache.splice(index,1)}})}};window.onerror=function(msg,url,line){logger.sendError({message:msg,url:url,line:line})};$(function(){logger.addLinkSoj("a[_soj]")})})();APF.Namespace.register("ajk");(function(){var a;ajk.DropDown=a=ajk.inherit(ajk.Observer,function(d,c,e){var b=this;b._op=$.extend({},{timer:500},e||{});b._target=d;b._list=c;b._timer;b.isOpen=false;b._bindEvent()});a.prototype._bindEvent=function(){var c=this;var b=function(){c._timer=setTimeout(function(){c.close()},c._op.timer)};c._target.on("mouseenter",function(){if(!c.isOpen){c.open()}});c._target.on("mouseleave",function(){if(c.isOpen){b()}});c._list.on("mouseenter",function(){clearTimeout(c._timer)});c._list.on("mouseleave",function(){if(c.isOpen){b()}});c._list.on("click",function(){c.close()})};a.prototype.open=function(){var b=this;if(b.trigger("open",arguments)!==false){b.isOpen=true;b._list.show()}};a.prototype.close=function(){var b=this;if(b.trigger("close",arguments)!==false){b.isOpen=false;b._list.hide()}}})();APF.Namespace.register("ajk");(function(a){ajk.DataCache=function(c){var b=this;b._cache=[];b.source=c};ajk.DataCache.prototype.get=function(l,k){var m=this,g=[],n=[],h=_.isArray(l)?l:[l];var b=function(o,j){if(!_.isArray(l)){k(o[0],j[0])}else{k(o,j)}};for(var e=0;e<h.length;e++){var c=m.find(h[e]);if(c!==null){g[e]=c}else{n.push({id:e,query:h[e]})}}if(n.length===0){b(g,h);return}for(var d=0,f=0;d<n.length;d++){(function(){var j=n[d];m.source(j.query,function(p){var o=m.add(j.query,p).data;g[j.id]=o;f++;if(f===n.length){b(g,h)}})})()}};ajk.DataCache.prototype.add=function(c,e){var b=this,d={key:c,data:e};b._cache.push(d);return d};ajk.DataCache.prototype.find=function(f){var d=this,c=null,e=0,b=d._cache.length;for(;e<b;e++){if(_.isEqual(d._cache[e].key,f)){c=d._cache[e].data;break}}return c}})(jQuery);APF.Namespace.register("ajk");(function(a){ajk.Autocomplete=ajk.inherit(ajk.Observer,function(c,e){var b='<ul class="auto-ul"><% _.each(obj,function(item){ %><li><span><%= item.keyword %></span><b>绾�<%= item.num %>濂�</b></li><%});%><ul>',d={dataSource:function(){},debounce:250,hasCache:true,insertDom:a("body"),template:_.template(b),itemSelector:"li",keySelector:"span",cursorClass:"auto-grayback",wrap:".auto-wrap",emptyFetch:false};this.op=a.extend({},d,e);this.op.wrapStyle=a.extend({},d.wrapStyle,e.wrapStyle);this.el=c;this._init()});ajk.Autocomplete.prototype._init=function(){this.wrap=null;this.sourceChecked=null;this.dataCenter=[];this.keyword=null;this._createWrap();this.resetCursored();this._checkSource();this._delay=false;if(this.op.hasCache){this.dataCache=new ajk.DataCache(this.sourceChecked)}this._bindEvent()};ajk.Autocomplete.prototype._createWrap=function(){if(this.op.wrap.constructor==jQuery){this.wrap=this.op.wrap.eq(0)}else{if(_.isString(this.op.wrap)){var c=a.trim(this.op.wrap);var b=c.substring(0,1);if(b=="."){this.wrap=a('<div class="'+c.slice(1)+'"></div>')}else{if(b=="<"){this.wrap=a(c)}}this.wrap.appendTo(this.op.insertDom)}}};ajk.Autocomplete.prototype._bindEvent=function(){this._onKeyup();this._onMouseover();this._onClick();this._onFocus();this._onBlur();this._isEnterWrap();this._onMousedown()};ajk.Autocomplete.prototype._onKeyup=function(){var b=this;b.el.on("keyup",function(c){b._updateKeyword();switch(c.keyCode){case 35:case 36:case 16:case 17:case 18:case 37:case 39:break;case 40:b.cursor(+1,true);break;case 38:b.cursor(-1,true);break;case 13:if(b.cursorIndex!=-1){b.select(b.wrap.find(b.op.itemSelector).eq(b.cursorIndex))}break;default:b._inputCheck(b.keyword);break}})};ajk.Autocomplete.prototype._isEnterWrap=function(){var b=this;b.wrap.on("mouseover",function(){b._delay=true});b.wrap.on("mouseout",function(){b._delay=false})};ajk.Autocomplete.prototype._onMouseover=function(){var b=this;b.wrap.on("mouseover",b.op.itemSelector,function(){b.cursorIndex=_index=a(this).index();b.cursor(_index)})};ajk.Autocomplete.prototype._onClick=function(){var b=this;b.wrap.on("click",b.op.itemSelector,function(){b.select(a(this))})};ajk.Autocomplete.prototype._onFocus=function(){var b=this;b.el.on("focus",function(){b._updateKeyword();b._inputCheck(b.keyword);if(b.trigger("onfocus",arguments)!==false){b.el.css("border-color","#f60")}})};ajk.Autocomplete.prototype._onMousedown=function(){var b=this;b.wrap.on("mousedown",function(c){c.preventDefault();b.cancelBlur=true;if(b.wrap.find(c.target).length>0){delete b.cancelBlur}})};ajk.Autocomplete.prototype._onBlur=function(){var b=this;b.el.on("blur",function(){if(b.cancelBlur){delete b.cancelBlur;return}if(b.trigger("onblur",arguments)!==false){b.el.css("border-color","#ccc");if(b._delay){setTimeout(function(){b.hide()},150)}else{b.hide()}}})};ajk.Autocomplete.prototype._updateKeyword=function(b){this.keyword=b||this.el.val()};ajk.Autocomplete.prototype._inputCheck=function(b){if(a.trim(b)===""){this.trigger("empty");if(this.op.emptyFetch){this.input(b)}}else{this.input(b)}};ajk.Autocomplete.prototype._checkSource=function(){var b=this;if(a.isFunction(b.op.dataSource)){b.sourceChecked=_.debounce(b.op.dataSource,b.op.debounce)}else{if(a.isArray(b.op.dataSource)){b.sourceChecked=b.op.dataSource}}};ajk.Autocomplete.prototype._updateData=function(){var c=this;if(a.isFunction(c.sourceChecked)){if(c.op.hasCache){c.dataCache.get(c.keyword,b)}else{c.sourceChecked(c.keyword,b)}}else{if(a.isArray(c.sourceChecked)){c.dataCenter=c.sourceChecked;c._render()}}function b(d){c.dataCenter=d;c._render()}};ajk.Autocomplete.prototype._render=function(){this.wrap.html(this.op.template(this.dataCenter));this.resetCursored();if(this.wrap.find(this.op.itemSelector).length>0){this.show()}else{this.hide()}};ajk.Autocomplete.prototype.show=function(){this.wrap.show()};ajk.Autocomplete.prototype.hide=function(){this.wrap.hide()};ajk.Autocomplete.prototype.resetCursored=function(){this.cursorIndex=-1;this.wrap.find(this.op.itemSelector).removeClass(this.op.cursorClass)};ajk.Autocomplete.prototype.cursor=function(f,e){var c=this,j,b,d={},h=arguments[1]===undefined?false:arguments[1],g=c.wrap.find(c.op.itemSelector);if(!h){j=f}else{j=c.cursorIndex+f;if(j>g.length-1){j=0}else{if(j<0){j=g.length-1}}}b=g.eq(j);d={index:j,item:b,data:c.dataCenter[j]};c.cursorIndex=j;if(c.trigger("cursored",[d])!==false){g.removeClass(c.op.cursorClass);b.addClass(c.op.cursorClass)}};ajk.Autocomplete.prototype.select=function(e){var d=this,g=e.index(),f={index:g,item:e,data:d.dataCenter[g]};var c=this.trigger("beforeSelected",[f]);var b=e.find(d.op.keySelector).text();d.el.val(c||b);if(this.trigger("selected",[f])!==false){d.hide()}};ajk.Autocomplete.prototype.input=function(b){if(this.trigger("inputed",arguments)!==false){self.keyword=b;this._updateData()}}})(jQuery);APF.Namespace.register("ajk.UserLogin");(function(){var d;var c='<div class="userlogin userblock userblockfirst"><i class="icon icon-people"></i><a class="link" href="<%= righturl.myanjuke %>" rel="nofollow" title="<%= common.usernamestr %>"><%= common.usernamestr %></a><i class="triangle-down"></i><ul><li><a href="<%= righturl.links.my_favorite %>" rel="nofollow">鎴戠殑鏀惰棌</a></li><li><a href="<%= righturl.links.view_history %>" rel="nofollow">娴忚鍘嗗彶</a></li><li><a href="<%= righturl.links.subscription_management %>" rel="nofollow">璁㈤槄绠＄悊</a></li><li><a href="<%= righturl.links.my_ask %>" rel="nofollow">鎴戠殑闂瓟</a></li><li><a href="<%= lefturl.pmurl %>" rel="nofollow">鎴戠殑娑堟伅<em><%= common.totalUnreadCount>99?"99+":common.totalUnreadCount %></em></a></li><li><a href="<%= righturl.links.my_ugc %>" rel="nofollow">鎴戠殑鐐硅瘎</a></li><li class="hr"></li><li><a target="_blank" href="<%= righturl.links.publish_sell || "#" %>?from=i_dhfa" rel="nofollow">鎴戣鍙戞埧</a></li><li><a target="_blank" href="<%= common.my_house||"#" %>?from=i_dhmge" rel="nofollow">鎴戠殑鎴挎簮</a></li><li class="hr"></li><li><a href="<%= lefturl.logouturl %>" rel="nofollow">閫€鍑�</a></li></ul></div>';var b='<div class="userlogin userblock userblockfirst"><span>鎮ㄥソ锛�<%= common.usernamestr %></span><a class="link" href="<%= lefturl.logouturl %>" rel="nofollow"> [閫€鍑篯 </a><a class="link usermsg" href="<%= lefturl.pmurl||"#" %>" rel="nofollow">娑堟伅 <i class="icon icon-point"><%= common.totalUnreadCount>99?"99+":common.totalUnreadCount %></i></a></div><div class="userblock"><a class="link" href="<%= righturl.myanjuke %>" rel="nofollow">涓浗缃戠粶缁忕邯浜�</a></div><% if( common.developUrl ){ %><div class=" userblock"><a class="link" href="<%= common.developUrl %>" rel="nofollow">鏂版埧鍒嗛攢骞冲彴</a></div><% } %>';var a='<div class="userlogin userblock userblockfirst"><span>鎮ㄥソ锛�<%= common.usernamestr %></span><a class="link" href="<%= lefturl.logouturl %>" rel="nofollow"> [閫€鍑篯 </a></div><div class="userblock "><a class="link usermsg" href="<%= lefturl.pmurl||"#" %>" rel="nofollow">娑堟伅 <i class="icon icon-point"><%= common.totalUnreadCount>99?"99+":common.totalUnreadCount %></i></a></div>';var e={"1":c,"9":c,"10":c,"2":b,"8":a};ajk.UserLogin=d=ajk.inherit(ajk.Observer,function(g){var f=this;f._op=$.extend({},{userbox:"#userbox",templates:e},g||{});f._userDate=null;f._init()});d.prototype._init=function(){var f=this;f.userbox=$(f._op.userbox);if(APF.Utils.getCookie("aQQ_ajkauthinfos")){f._op.getUserInfo({},function(g){f._userDate=g;f.updateUserInfo();f._bindEvent()})}else{f._bindEvent()}};d.prototype._bindEvent=function(){var f=this;if(!f.isLogin()){new ajk.DropDown($(".brokerlogin>.link"),$(".brokerlogin>ul"))}new ajk.DropDown($(".userlogin>.link"),$(".userlogin>ul"))};d.prototype.updateUserInfo=function(){var f=this;if(!f.isLogin()){return}var g=f.getUserTpl();f.userbox.html(g(f._userDate))};d.prototype.isLogin=function(){return this._userDate&&this._userDate.common.userid};d.prototype.getUserTpl=function(){var f=this;var g=f._userDate.common.usertype+"";return _.template(f._op.templates[g])}})();$(function(){var a=function(b){var d=b;var c=setTimeout(function(){d.hide()},500);d.data("hiddenTimer",c)};$("#footer").on("click","[data-target]",function(c){c.preventDefault();var b=$(this).data("target");$("#"+b).toggle()});$("#footer").on("mouseout","[data-target]",function(){var b=$(this).data("target");a($("#"+b))});$("#other_city,#community_link,#map_link,#house_link").hover(function(){var b=$(this).data("hiddenTimer");clearTimeout(b)},function(){a($(this))})});APF.Namespace.register("ajk.pc");(function($){var sideBar;ajk.pc.sideBar=sideBar=function(op){this._op=$.extend({},{sideBarBox:$(".sidebar"),toTop:$(".sidebar-top"),sidebarNav:$(".sidebar-mod a"),minWidth:1280,minTop:400},op||{});this.init()};sideBar.prototype.init=function(){var self=this;self.addLinkSoj("a[data-soj]");self.checkVisible();$(window).on("scroll resize",function(){self.checkVisible()});self._op.toTop.on("click",function(e){self.sendSoj({site:"anjuke-npv",pn:"track_back_top_click"});$("html,body").animate({scrollTop:0},100)});$("#sid_survey").on("click",function(){self.sendSoj({site:"anjuke-npv",pn:"track_survey_click"})})};sideBar.prototype.checkVisible=function(){var self=this,winWidth=$(window).width(),scrollTop=$(window).scrollTop();if(winWidth>self._op.minWidth){self._op.sideBarBox.show();self._op.sideBarBox.stop().animate({right:"0px"},100);self._op.toTop.removeClass("sd-top-sig")}else{self._op.sideBarBox.stop().animate({right:"-40px"},100);self._op.toTop.addClass("sd-top-sig")}if(scrollTop>self._op.minTop){self._op.toTop.show()}else{self._op.toTop.hide()}self.slideNav()};sideBar.prototype.slideNav=function(){var self=this;self._op.sidebarNav.hover(function(){var hoverWidth=$(this).children(".sidebar-nav-hover").hasClass("sidebar-sao")?"130px":"90px";$(this).children(".sidebar-nav-hover").stop().animate({width:hoverWidth},100)},function(){$(this).children(".sidebar-nav-hover").stop().animate({width:"0px"},100)})};sideBar.prototype.sendSoj=function(op){var self=this;if(ajk&&ajk.Logger){ajk.Logger.sendSoj({page:op.pn,site:op.site,pageName:op.pn})}else{if(J&&J.site&&J.site.trackEvent){J.site.trackEvent(op.pn)}}};sideBar.prototype.addLinkSoj=function(selector,attr,param){$("body").on("click",selector,function(e){var soj=$(this).data(attr||"soj")||$(this).attr(attr||"data-soj"),_soj=$.trim(soj),href=$.trim($(this).attr("href")),_param=param||"from",_target=$(this).attr("target"),_hasTarget=_target!==undefined,_href;if(!_soj){return}if(!href){return}if(href.toLowerCase().indexOf("javascript")===0){return}e.preventDefault();e.stopPropagation();href=href.replace(/(&from=(.)*$)|(\?from=(.)*$)/,"");_href=(href.indexOf("?")!==-1)?href+"&"+_param+"="+_soj:href+"?"+_param+"="+_soj;if(_hasTarget){if(!
/*@cc_on!@*/
0){var winoper=window.open(_href,_target);winoper&&winoper.focus()}else{var _el=document.createElement("a");_el.href=_href;_el.target=_target;$(_el).appendTo("body").get(0).click();$(_el).remove()}}else{location.href=_href}})}})(jQuery);APF.Namespace.register("ajk");(function(a){var b=ajk.Roller=ajk.inherit(ajk.Observer,function(e){var c='<div class="exia-box" style="height:<%= height %>px"><div class="sol-label"><span data-val="" data-title="<%= title %>" style="height:<%= height %>px"><%= title %></span><i style="top:<%= top %>px" class="icon icon-seldown"></i></div><ul style="width:<%= width %>px;top:<%= height %>px;"></ul></div>';var f='<li style="height:<%= height %>px;line-height:<%= height %>px;" data-val="<%= value %>"><%= desc %></li>';var d='<option value="<%= value %>"><%= desc %></option>';this.op=a.extend({boxId:"selectbox",zcord:1,trigger:"click",title:undefined,onchange:undefined,crTpl:_.template(c),imTpl:_.template(f),slTpl:_.template(d),rrClass:"exia-box",teClass:"exia-light",downClass:"icon-seldown",upClass:"icon-selup",liClass:"li-over",liStClass:"li-static",labelClass:"sol-label",resetValue:undefined,triggerChange:true,onchange:function(){},onLabelClick:function(){}},e);this.effective=true;this.container=a("#"+this.op.boxId);this.originSel=this.container.find("select");this.initial()});b.prototype.initial=function(){this.drawRoller();this.bindEvent();this.press(0,true)};b.prototype.drawRoller=function(){var l=this,d=this.container,h=d.children("select"),k=l.op.rrClass;var j=d.innerHeight()-2;var e=d.innerWidth()-2;var g=Math.ceil((j-7)/2);var c=l.op.crTpl({value:h.val(),title:l.op.title||h.find("option:first").text(),height:j,width:e,top:g});d.append(c);var f="";h.children("option").each(function(m,o){var n=a(o).prop("value"),p=a(o).text();f+=l.op.imTpl({height:j+2,desc:p,value:n})});d.find("."+k+" ul").append(f)};b.prototype.bindEvent=function(){var c=this;var f=this.container;var d=c.op.rrClass;var e=f.find("."+d);e.bind(c.op.trigger,function(g){var h=a(g.srcElement||g.target);if(g.type=="mouseout"||g.type=="mouseleave"&&!e.find("ul").is(":visible")){return}e.find("ul").is(":visible")?f.css("zIndex",c.op.zcord):f.css("zIndex","999");e.find("i").toggleClass(c.op.downClass+" "+c.op.upClass);e.find("ul").toggle();e.toggleClass(c.op.teClass)});f.on("click","."+d+" li",function(g){c.handlePress(a(this))});f.on("click","."+c.op.labelClass+" span",function(){var g=a(this).data("val");c.op.onLabelClick(g)});f.on("mouseover mouseleave","."+d+" li",function(g){a(this).toggleClass(c.op.liClass)});if(c.op.trigger=="click"){a("body").on("click",function(g){var h=a(g.srcElement||g.target);if(!h.parents("#"+c.op.boxId).length&&!h.is("#"+c.op.boxId)&&e.find("ul").is(":visible")){c.shrink()}})}};b.prototype.shrink=function(){var c=this;var f=this.container;var d=c.op.rrClass;var e=f.find("."+d);f.css("zIndex",c.op.zcord);e.children("ul").hide();e.removeClass(c.op.teClass);e.find("i").removeClass(c.op.upClass).addClass(c.op.downClass)};b.prototype.handlePress=function(g,c){var l=this;var d=this.container;var j=l.op.rrClass;var e=d.find("."+j);var k=g,f=k.text(),h=k.attr("data-val");if(l.op.resetValue&&l.op.resetValue==h){f=l.op.title}e.find("."+l.op.labelClass+" span").attr("data-val",h).html(f);k.siblings().removeClass(l.op.liStClass);k.addClass(l.op.liStClass);l.originSel.val(h);if(l.op.triggerChange){l.originSel.change()}!c&&l.op.onchange(h);l.shrink()};b.prototype.press=function(e,h){var c=this;var g=this.container;var d=c.op.rrClass;var f=g.find("."+d);c.handlePress(f.children("ul").find("li:eq("+e+")"),h)};b.prototype.valid=function(c){this.effective=c};b.prototype.val=function(g,h){var d=this,f=this.container,c=d.op.labelClass,e=f.find("."+c);if(g!=undefined){e.next().find("li").each(function(j,k){if(a(k).attr("data-val")==a.trim(g)){d.press(j,h)}});return d}else{return e.children("span").attr("data-val")}};b.prototype.reset=function(c,e){var g="",h="";var f=this.container;var j=f.innerHeight();var l=this.op.labelClass;var k=f.find("."+l);for(var d=0;d<c.length;d++){g+=this.op.imTpl({height:j,value:c[d].value,desc:c[d].desc});h+=this.op.slTpl({value:c[d].value,desc:c[d].desc})}k.children("span").attr("data-title",c[0].desc);k.next().html(g);this.originSel.html(h);this.press(0,e)}})(jQuery);$(function(){$("#navigation>li").hover(function(){$(this).addClass("hover")},function(){$(this).removeClass("hover")});var a=$(".nav-triangle");a.each(function(d,c){var g=$(this);var e=g.parent().parent(),f=0;e&&(f=(e.width()-14)/2);g.css("left",f)});var b=$("#user_box");b.hover(function(){b.addClass("hover")},function(){b.removeClass("hover")})});(function(b){var a={arrowDirection:"tb",arrowPosition:"left"};(function(h){var g,n,m,j,k,e={};k=b("body");g=b('<div style="position:absolute;z-index:10000"><div class="tooltip-wrap"><div class="tooltip-arrow arr-top"><div class="tooltip-arrowbg"></div></div><div class="tooltip-msg"></div></div></div>');n=g.find(".tooltip-msg");m=g.find(".tooltip-arrow");j={upwards:"arr-top",rightwards:"arr-right",downwards:"arr-bottom",leftwards:"arr-left"};function c(o){n.html(o)}function d(u,s){m.attr("style","");for(var p in j){m.removeClass(j[p])}var r=b(u),z=r.offset(),o=r.outerWidth(),t=r.outerHeight(),x=s.arrowPosition,q=s.arrowDirection,w={left:0,top:0,excursion:12};g.hide().appendTo(k);g.width(s.width||"auto");if(q=="tb"){if(x=="left"){w.left=z.left+o/2-28;m.css("right","initial");m.css(x,"19px")}else{if(x=="right"){w.left=z.left-g.width()+o/2+28;m.css("left","initial");m.css(x,"19px")}else{if(x=="center"){m.addClass("arr-center");w.left=z.left+o/2-g.width()/2}}}var y=b(document).scrollTop(),v=document.documentElement.clientHeight;if(t+w.excursion+z.top+g.height()-y>v){q=j.downwards;w.top=z.top-g.height()-w.excursion}else{q=j.upwards;w.top=z.top+t+w.excursion}m.addClass(q)}if(q=="lr"){w.top=z.top-g.height()/2+t/2;if(z.left+o+w.excursion>document.documentElement.clientWidth){q=j.rightwards;w.left=z.left-g.width()-w.excursion}else{q=j.leftwards;w.left=z.left+o+w.excursion}m.css("top",g.height()/2-8+"px");m.addClass(q)}g.css({left:w.left,top:w.top});g.show()}function l(q,p,o){c(q);d(p,o);b(p).trigger("tipshow")}function f(p,o){if(o==e.targetDom){c(p);d(o,e.op);b(o).trigger("tipshow")}}b.fn[h]=function(p,o){return this.each(function(){var q=b(this);q.on("mouseover",function(s){s.stopPropagation();var r=b(this);clearTimeout(window.stt);clearTimeout(window.sttt);window.stt=window.sttt=undefined;window.st=setTimeout(function(){var u=typeof p;o=b.extend({},a,o);if(u=="string"){var t=p;l(t,r[0],o)}if(u=="function"){e.op=o;e.targetDom=r[0];l("璇风◢鍚庛€傘€傘€�",r[0],o);p.call(r[0],f)}},150)});q.on("mouseout",function(s){s.stopPropagation();var r=this;clearTimeout(window.st);clearTimeout(window.stt);window.st=undefined;window.stt=setTimeout(function(){b(e.targetDom).trigger("tiphide");e.targetDom=null;g.detach()},200)})})};g.on("mouseenter",function(o){clearTimeout(window.stt);window.stt=undefined;o.stopPropagation()});g.on("mouseleave",function(o){o.stopPropagation();window.sttt=setTimeout(function(){b(e.targetDom).trigger("tiphide");g.detach()},150)});b(document).ready(function(){k=b("body");b("[data-autoTips]").on("mouseover",function(p){p.stopPropagation();var o=b(this);clearTimeout(window.stt);clearTimeout(window.sttt);window.stt=window.sttt=undefined;window.st=setTimeout(function(){e.targetDom=null;var r,s,q={};r=o.attr("data-autoTips");s=r.replace(/^(.+)(,{{(right|bottom)}})$/g,"$1");q.arrowPosition=r.match(/(,{{(right|bottom)}})$/g);q.arrowPosition=q.arrowPosition?q.arrowPosition[0].replace(/.+(right|bottom).+/g,"$1"):"left";q=b.extend({},a,q);l(s,o[0],q)},150)});b("[data-autoTips]").on("mouseout",function(p){p.stopPropagation();var o=this;clearTimeout(window.st);window.st=undefined;window.stt=setTimeout(function(){g.detach()},200)})})})("toolTip")})(jQuery);APF.Namespace.register("ajk.Validate");(function(b){var a=ajk.inherit(ajk.Observer,function(g,e,f){var d=this;d.dom=g;d.rules=e;d._op=b.extend({},a._default,f||{});d._errorId=null;d._isRemoteing=false;d._rulesBase;d._init()});a.prototype._init=function(){var d=this,e=d.dom.attr("type");d._rulesBase=(e=="radio"||e=="checkbox")?c.rulesCheckbox:c.rulesText;if(d.dom.attr("type")=="checkbox"||d.dom.attr("type")=="radio"){d.dom.on(d._op.eventCheckbox,function(){d.check()});return}if(d.dom.filter("select").length>0){d.dom.on(d._op.eventSelect,function(){d.check()})}else{d.dom.on(d._op.eventText,function(){d.check()})}};a.prototype.check=function(){var e=this;var d=true;var k=function(l){if(typeof l=="string"){l=e._rulesBase[l]}return l};for(var f=0,h=e.rules;f<h.length;f++){var g=k(h[f].rule);var j=g.apply(e,[e.dom,h[f].args,h[f].msg,f]);if(!j){if(!(h[f].rule=="remote"&&(!e.dom.data("remote")||e.dom.data("remote")==""))){e._errorId=f;e.trigger("error",["error",e,h[f].msg||""])}d=false;break}}if(d){e._errorId=null;e.trigger("success",["success",e])}return d};a.prototype.status=function(){var d=this,e;if(d._isRemoteing){e={status:"remote"};return e}if(d._errorId==null){e={status:"success"}}else{e={status:"error"};e.msg=d.rules[d._errorId].msg}return e};a.prototype.upDateMsg=function(d,f){var e=this,g=0,h=d;if(typeof h=="string"){for(;g<e.rules.length;g++){if(e.op.checklist[g].rule===h){h=g;break}}}e.rules[g].msg=f;if(e._errorId==g){e.trigger("error",["error",e,f])}};a.prototype.addRules=function(e){var d=this;d.rules=d.rules.concat(e)};a.prototype.removeRules=function(g){var d=this;for(var f=arguments.length-1;f>=0;f--){for(var e=d.rules.length-1;e>=0;e--){if(d.rules[e]==arguments[f]){d.rules.splice(e,1);break}}}};a._default={eventCheckbox:"click",eventSelect:"change",eventText:"blur"};var c=ajk.inherit(ajk.Observer,function(e,f){var d=this;d._op=b.extend({},c._default,f);d._skipList=[];d.filds={};d._init(e)});c.prototype._init=function(e){var d=this;b.each(e,function(f,g){d.add(g)});b(d._op.formSelect).on("submit",function(){return d.checkAll()})};c.prototype.add=function(f){var e=this,g=b(f.selector);if(g.length<=0||f.checklist.length<=0){return}var d=g.attr("name");e.filds[d]=new a(g,f.checklist,e._op);e.filds[d].on("error success remoteBegin remoteEnd",function(j,h,k){e._op.singleHandle(h.dom,j,h,k)})};c.prototype.remove=function(e){var d=this,f;if(d.filds[e]){f=d.filds[e];delete d.filds[e]}return f};c.prototype.checkAll=function(l){var g=this,d=true,e=false,j=l?[]:g._skipList;for(var h in g.filds){if(b.inArray(h,j)>=0){continue}var k=g.filds[h].check();if(!k){if(!e){g.trigger("firstError",[g.filds[h].dom]);e=true}d=false}}var f=d?"success":"error";g.trigger(f);return d};c.prototype.checkAsList=function(g){var e=this,d=true;for(var f=0;f<g.length;f++){var h=e.filds[g[f]].check();if(!h){d=false}}return d};c.prototype.addSkip=function(f){var d=this,g=(typeof f=="string")?[f]:f;for(var e=0;e<g.length;e++){if(b.inArray(g[e],d._skipList)>=0){continue}d._skipList.push(g[e])}};c.prototype.removeSkip=function(g){var d=this,f=[],h=(typeof g=="string")?[g]:g;for(var e=0;e<d._skipList.length;e++){if(b.inArray(d._skipList[e],h)>=0){continue}f.push(d._skipList[e])}d._skipList=f};c._default={formSelect:"",singleHandle:function(k,h,g,j){var f='<div class="ui message error"><i class="ui icon predefine"></i><div class="content">{%= msg %}</div></div>';if(!g.msgBox||g.msgBox.length<1){g.msgBox=b(_.template(f)({msg:j||""}));g.dom.parents(".field").append(g.msgBox)}switch(h){case"error":g.msgBox.removeClass("success remote").addClass("error").find(".content").html(j).show();break;case"success":g.msgBox.removeClass("error remote").addClass("success").find(".content").html("").show();break;case"remoteBegin":g.msgBox.removeClass("success error").addClass("remote").find(".content").html("鍔犺浇涓�...").show();break;case"remoteEnd":var d=g.status(),j=(d.status=="error")?d.msg:"",e=(d.status=="error")?"error":"success";g.msgBox.removeClass("remote error success").addClass(e).find(".content").html(j).show();break;default:g.msgBox.hide()}}};c.rulesText={required:function(d){var e=d.val();var e=b.trim(e);return e.length>0&&e!=d.attr("placeholder")},integer:function(d){var e=d.val();return/^\-?[\d]*$/.test(e)},equal:function(d,e){var f=d.val();return f===e},not:function(d,e){var f=d.val();return f!=e},maxLength:function(e,d){var f=e.val();return f.length<=d},minLength:function(e,d){var f=e.val();return f.length>=d},max:function(e,d){var f=e.val()-0;return f-d<=0},min:function(e,d){return e.val()-0-d>=0},email:function(d){var e=d.val();return/^[a-z0-9_-]+@[a-z0-9_-]+\.\w{2,3}$/i.test(e)},ucode:function(d){var e=d.val();return/^[U]{0,1}\d{12}$/.test(e)},number:function(d){var e=d.val();return !isNaN(e)},remote:function(j,d,h,f){var n=this,e=h,o=j.data("remote"),g=j.val(),l=b.extend({},{type:"post",url:"",loading:"楠岃瘉涓�...",dataType:"json",dataInit:function(p){return p.val()},resultInit:function(p){return p}},d);if(o&&o!=""&&o==g){return true}else{var m=l.dataInit(j);n._isRemoteing=true;n.trigger("remoteBegin",["remoteBegin",n,l.loading]);var k=function(p){var p=l.resultInit(p);if(!!p.st==true){j.data("remote",p.val);if(j.val()==p.val){n._errorId=null;n.trigger("success",["success",n])}else{n._errorId=f;n.trigger("error",["error",n,e])}}else{var q=e;n._errorId=f;n.trigger("error",["error",n,q])}n._isRemoteing=false;n.trigger("remoteEnd",["remoteEnd",n])};b.ajax({type:l.type,dataType:l.dataType,url:l.url,data:{w:m},success:k,error:function(){n._errorId=f;n.trigger("error",["error",n,e])}})}}};c.rulesCheckbox={required:function(d){return d.filter(":checked").length>0},maxNumber:function(e,d){return e.filter(":checked").length<=d}};ajk.Validate=c})(jQuery);function Guesslike(b){var a=_.template($("#guesslike-tpl").html());$.ajax({url:b.url,type:"GET",dataType:"json",data:{guid:b.guid,city_id:b.city_id,entry:b.entry}}).done(function(c){var d=c.interest_props;if(d.length<4){$(b.hideSelector).hide()}else{if(d.length>4){d=_.first(d,4)}ajk.Logger.sendSoj({site:"anjuke-npv",customparam:JSON.stringify(c.soj_data_interest)});$("#guesslike-content").html(a(d));$("#guesslike-content").on("click","li",function(){$(this).find("a").get(0).click()})}}).fail(function(){$(b.hideSelector).hide()})}APF.Namespace.register("ajk.Calculator");(function(){ajk.Calculator.Mortgage=function(){};ajk.Calculator.Mortgage.prototype={monthRepay:function(h,f,e,c,b){var a=c||1,g=b||0;if(a==1){var d=Math.pow(1+e,f);return h*e*d/(d-1)}else{return(h-g*h/f)*e+h/f}},monthInterest:function(h,f,e,d,c){var a=d||1,g=c||0;if(a==1){var b=this.monthRepay(h,f,e,d);return((h*e-b)*Math.pow((1+e),g)+b)}else{return(h-g*h/f)*e}},totalRepay:function(f,e,d,b){var a=b||1;if(a==1){var c=Math.pow(1+d,e);return f*d*c/(c-1)*e}else{return(e+1)*f*d/2+f}},totalInterest:function(f,e,d,b){var a=b||1;if(a==1){var c=Math.pow(1+d,e);return f*d*c/(c-1)*e-f}else{return(e+1)*f*d/2}},capitalEvaluate:function(d,a,c){var b=Math.pow(1+c,d);return a*(b-1)/(c*b)},getLoanRate:function(c,a){var b;c=parseInt(c);if(!_.isNumber(c)&&_.isNaN(c)){return}if(c<=6){b=a[0]}else{if(c<=12&&c>6){b=a[1]}else{if(c<=36&&c>12){b=a[2]}else{if(c<=60&&c>36){b=a[3]}else{b=a[4]}}}}return b},getGjjRate:function(b,a){b=parseInt(b);if(!_.isNumber(b)&&_.isNaN(b)){return}return b<=60?a[0]:a[1]},ershouLink:function(c,e){var b=e||location.protocol+"//shanghai.anjuke.com/sale/";var f=Math.round(parseFloat(c));var d=Math.round(f*0.9);var a=Math.round(f*1.1);b=b+"?from_price="+d+"&to_price="+a;$(".result-link").attr("href",b).find("em").text(d+"涓�-"+a+"涓�")}}})();APF.Namespace.register("ajk.Calculator");(function(a){ajk.Calculator.Loan=function(A,g,D,c){var t=a("#calType"),G=a("#discount").add(a("#discount-part2")),j=a("#totalCapital"),x=j.find("input"),d=a("#capitalPercent"),H=a("#bizRate"),m=H.find("input"),F=a("#gjjRate"),n=F.find("input"),k=a("#bizCapital"),z=k.find("input"),l=a("#gjjCapital"),p=l.find("input"),C=a('[name="repaytype"]'),o=a('[name="loantype"]'),h=a('[name="caltype"]'),r=a('[name="discount"]'),q=r.filter(":eq(1),:eq(2)").parent();var w=new ajk.Calculator.Mortgage();var f=_.template(a("#cal-loan-tpl").html());var b=new ajk.Roller({boxId:"prePay"});var y=new ajk.Roller({boxId:"loanTime"});y.val(240);y.on("onchange",function(){u()});e();a("#startCal").on("click",function(){var I=v.checkAll();if(!I){return}s()});a("#resetCal").on("click",function(){window.location.reload()});var v=new ajk.Validate([{selector:'#calleft [name="total-capital"]',checklist:[{rule:"required",msg:"閲戦涓嶈兘涓虹┖"},{rule:"number",msg:"閲戦蹇呴』涓烘暟瀛�"},{rule:function(M,I,K){var L=parseFloat(M.val());return L>0},msg:"閲戦蹇呴』澶т簬0"}]},{selector:'#calleft [name="gjj-capital"]',checklist:[{rule:"required",msg:"閲戦涓嶈兘涓虹┖"},{rule:"number",msg:"閲戦蹇呴』涓烘暟瀛�"},{rule:function(M,I,K){var L=parseFloat(M.val());return L>0},msg:"閲戦蹇呴』澶т簬0"}]},{selector:'#calleft [name="biz-capital"]',checklist:[{rule:"required",msg:"閲戦涓嶈兘涓虹┖"},{rule:"number",msg:"閲戦蹇呴』涓烘暟瀛�"},{rule:function(M,I,K){var L=parseFloat(M.val());return L>0},msg:"閲戦蹇呴』澶т簬0"}]},{selector:'#calleft [name="biz-rate"]',checklist:[{rule:"required",msg:"鍒╃巼涓嶈兘涓虹┖"},{rule:"number",msg:"鍒╃巼蹇呴』涓烘暟瀛�"},{rule:function(M,I,K){var L=parseFloat(M.val()).toFixed(2);M.val(L);return L>0&&L<100},msg:"鍒╃巼蹇呴』鍦�0-100%涔嬮棿"}]},{selector:'#calleft [name="gjj-rate"]',checklist:[{rule:"required",msg:"鍒╃巼涓嶈兘涓虹┖"},{rule:"number",msg:"鍒╃巼蹇呴』涓烘暟瀛�"},{rule:function(M,I,K){var L=parseFloat(M.val()).toFixed(2);M.val(L);return L>0&&L<100},msg:"鍒╃巼蹇呴』鍦�0-100%涔嬮棿"}]}],{formSelect:"#calleft",singleHandle:function(){var I=arguments[0];result=arguments[1];msg=arguments[3];warnBox=I.parents(".item-mod").find(".warn");if(result=="success"){warnBox.hide()}else{warnBox.text(msg).show()}}});function s(){var M={loanType:o.filter(":checked").val(),repayType:C.filter(":checked").val(),calType:h.filter(":checked").val()};if(M.loanType==1||M.loanType==2){var S=x.val()-0,T=M.loanType==1?n.val()/100:m.val()/100,R;M.gjjRate=M.bizRate=(T*100).toFixed(2);M.month=R=y.val()-0;if(M.calType==2){M.housePrice=S;M.downPayment=(S*(b.val()-0)).toFixed(2);M.totalCapital=S=M.housePrice-M.downPayment;M.totalCapital=M.totalCapital.toFixed(2)}else{M.totalCapital=S}if(M.repayType==1){M.totalRepay=w.totalRepay(S,R,T/12,1).toFixed(2);M.totalInterest=(M.totalRepay-S).toFixed(2);M.monthRepay=(M.totalRepay/R*10000).toFixed(2)}else{var W=w.totalRepay(S,R,T/12,2);M.totalRepay=parseFloat(W).toFixed(2);M.totalInterest=(M.totalRepay-S).toFixed(2);M.firstRepay=(w.monthRepay(S,R,T/12,2,0)*10000).toFixed(2);M.lastRepay=(w.monthRepay(S,R,T/12,2,R-1)*10000).toFixed(2)}}else{M.gjjCapital=p.val()-0;M.bizCapital=z.val()-0;M.totalCapital=M.gjjCapital+M.bizCapital;M.gjjRate=n.val();M.bizRate=m.val();var K=n.val()/100,U=m.val()/100,R;M.month=R=y.val()-0;if(M.repayType==1){var P=w.totalRepay(M.gjjCapital,R,K/12,1),L=P-M.gjjCapital,Y=P/R;var N=w.totalRepay(M.bizCapital,R,U/12,1),X=N-M.bizCapital,Q=N/R;M.totalRepay=(P+N).toFixed(2);M.totalInterest=(L+X).toFixed(2);M.monthRepay=((Y+Q)*10000).toFixed(2)}else{var P=w.totalRepay(M.gjjCapital,R,K/12,2),L=P-M.gjjCapital,Z=w.monthRepay(M.gjjCapital,R,K/12,2,0),I=w.monthRepay(M.gjjCapital,R,K/12,2,R-1);var N=w.totalRepay(M.bizCapital,R,U/12,2),X=N-M.bizCapital,V=w.monthRepay(M.bizCapital,R,U/12,2,0),O=w.monthRepay(M.bizCapital,R,U/12,2,R-1);M.totalRepay=(P+N).toFixed(2);M.totalInterest=(L+X).toFixed(2);M.firstRepay=((Z+V)*10000).toFixed(2);M.lastRepay=((I+O)*10000).toFixed(2)}}E(M)}function E(I){if(I.calType==1){w.ershouLink(I.totalCapital/0.7,c)}else{w.ershouLink(I.housePrice,c)}a("#caldefault").hide();a("#table-wrap").html(f(I));a("#result-table").show()}function e(){h.on("click",function(){if(a(this).val()==1){j.find("label>span").text("璐锋鎬婚");d.hide()}else{b.val(0.3);j.find("label>span").text("鎴垮眿鎬讳环");d.show()}B()});o.on("click",function(){if(a(this).val()==3){H.find("label span").text("鍟嗚捶鍒╃巼");H.find("input").val((g[4]*100).toFixed(2));F.find("label span").text("鍏Н閲戝埄鐜�");F.find("input").val((A[1]*100).toFixed(2));H.show();F.show();k.show();l.show();d.hide();t.hide();j.hide();G.hide()}else{if(a(this).val()==1){F.find("label span").text("鍒╃巼");F.show();H.hide();r.eq(0).prop("checked",true);q.hide()}else{H.find("label span").text("鍒╃巼");H.show();F.hide();q.show()}G.show();t.show();j.show();u();k.hide();l.hide()}B()});r.on("click",function(){u()});var K='<span style="color:#333">绛夐鏈伅:</span>绛夐鏈伅杩樻,涔熺О瀹氭湡浠樻伅,鍗冲€熸浜烘瘡鏈堟寜鐩哥瓑鐨勯噾棰濆伩杩樿捶娆炬湰鎭�,鍏朵腑姣忔湀璐锋鍒╂伅鎸夋湀鍒濆墿浣欒捶娆炬湰閲戣绠楀苟閫愭湀缁撴竻銆�<br/><span style="color:#333">绛夐鏈噾:</span>鍙堢О鍒╅殢鏈竻銆佺瓑鏈笉绛夋伅杩樻娉曘€傝捶娆句汉灏嗘湰閲戝垎鎽婂埌姣忎釜鏈堝唴,鍚屾椂浠樻竻涓婁竴浜ゆ槗鏃ヨ嚦鏈杩樻鏃ヤ箣闂寸殑鍒╂伅銆�';var L="鏍规嵁"+D[0]+"骞�"+D[1]+"鏈�"+D[2]+"鏃ユ渶鏂伴摱琛屽埄鐜囷細鍏Н閲慬5骞翠互涓嬶細"+(A[0]*100).toFixed(2)+"%锛堝寘鎷�5骞达級锛�5骞翠互涓婏細"+(A[1]*100).toFixed(2)+"%]锛涘晢涓氳捶娆綶0~1骞达細"+(g[1]*100).toFixed(2)+"%锛堝寘鎷�1骞达級锛�1~5骞达細"+(g[3]*100).toFixed(2)+"%锛堝寘鎷�5骞达級锛�5骞翠互涓婏細"+(g[4]*100).toFixed(2)+"%]";var I='<span style="color:#333">娓╅Θ鎻愮ず:</span><br/>1 鏈粨鏋滄寜鐓ф埧璐疯绠楀櫒2015鏈€鏂板埄鐜囪绠椼€�<br/>2 瀵瑰凡璐锋璐拱涓€濂椾綇鎴夸絾浜哄潎闈㈢Н浣庝簬褰撳湴骞冲潎姘村钩锛屽啀鐢宠璐拱绗簩濂楁櫘閫氳嚜浣忔埧鐨勫眳姘戯紝姣旂収鎵ц棣栨璐锋璐拱鏅€氳嚜浣忔埧鐨勪紭鎯犳斂绛栥€�<br/>3 鏍规嵁'+D[0]+"骞�"+D[1]+"鏈�"+D[2]+"鏃ユ渶鏂板喅瀹氾紝涓嬭皟浜烘皯甯佸瓨璐锋鍩哄噯鍒╃巼0.25涓櫨鍒嗙偣锛堝凡鏇存柊鑷虫渶鏂板埄鐜囷級銆�";a("#repaytype-tips").toolTip(K,{width:440});a("#gjj-help").toolTip(L,{width:440});a("#biz-help").toolTip(L,{width:440});a("#result-help").toolTip(I,{width:440})}function u(){var K=r.filter(":checked").val();var L=w.getLoanRate(y.val(),g)*100;var I=w.getGjjRate(y.val(),A)*100;m.val((K*L).toFixed(2));n.val((K*I).toFixed(2))}function B(){a(".warn").text("")}}})(jQuery);